<style>
   .text-help { font-size: 11px; font-weight: 500; color: #ff5722; }

</style>

<nav aria-label="breadcrumb">
   <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="cpanel/home" class="alink">Dashboard</a></li>
      <li class="breadcrumb-item"><a href="cpanel/route/lists" class="alink" >Route</a></li>

      <li class="breadcrumb-item active" aria-current="page">Edit</li>
   </ol>
</nav>
<!--/end Breadcrumb-->

<!-- // Start Content on PAGE /////////////////////////////////////////////////////// -->
<div class="row">
   <div class="content-title">
      <div class="col-md-8 col-sm-8 col-xs-12">
         <h2>Route <b>Edit</b></h2>
      </div><!--/col-->
   </div><!--/content-title-->
</div><!--/row-->

<div class="row" id='route_edit_page'>
   <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="x_panel">
         <div class="x_title">
            <p class="text-th">แก้ไขข้อมูลเส้นทางเดินรถ หมายเลข <span>( <span class="route_id"></span> | <span class="route_name"></span> - <span class="route_area"></span>)</span></p>

         </div>
         <!--/x_title-->



         <div class="x_content">
            <form id="editRoute" class="form-horizontal form-label-left" method="POST" data-parsley-validate="" novalidate>
               <input type="hidden" name="action" value="editroute">
               <!-- <input id="bywho" name="bywho" value="<?=$_SESSION['name']?>" style="display:none;" />
               <input id="when" name="when" value="<?=date('Y-m-d H:i:s')?>" style="display:none;" />  -->
               <div class="row route_edit_page" >
                  <div class="col col-md-3 col-sm-4 col-xs-12 col-image">
                     <div class="form-group" style="text-align:center;"> <i class="fa fa-fw fa-book" style=" font-size:12vw; margin:0 auto;"></i> </div>
                  </div>
                  <!--/col-->

                  <div class="col col-md-9 col-sm-8 col-xs-12">
                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12"><span class="required">*</span> Route Name (English)</label>
                        <div class="col-md-9 col-sm-9 col-xs-12">
                           <input class="form-control route_name" type="text" id="routename" name="name" value="" required="required" />
                           <span class="text-help chk_name"></span>
                        </div>
                     </div>


                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12"><span class="required">*</span> Area Name (Thai)</label>
                        <div class="col-md-9 col-sm-9 col-xs-12">
                           <input class="form-control route_area" type="text" id="areaname" name="areaname" value="" required="required" />
                           <span class="text-help chk_area"></span>
                        </div>
                     </div>



                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12">Description</label>
                        <div class="col-md-9 col-sm-9 col-xs-12">
                           <textarea class="resizable_textarea form-control route_description"  rows="5" id="description" name="description" ></textarea>

                        </div>
                     </div>

                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12">Status</label>
                        <div class="col-md-9 col-sm-9 col-xs-12">
                           <select id="status" class="route_status form-control input-sm selectpicker selectCustomW100">
                              <option value="1">เปิดการใช้งาน</option>
                              <option value="0">ปิดการใช้งาน</option>
                           </select>

                        </div>
                     </div>


                  </div>
                  <!--/col-->

               </div>
               <!--/row-->

               <div class="row">
                  <div class="ln_solid"></div>
                  <div class="col-md-3 col-sm-6 col-xs-12"><a href="/cpanel/route/lists" class="alink btn btn-default btn-lg btn-block">Back</a></div>
                  <div class="col-md-9 col-sm-6 col-xs-12">
                     <button class="btn btn-primary btn-lg btn-block" type="submit" >Submit Edited</button>
                  </div>
               </div>
               <!--/row-->

            </form>
         </div>
         <!--/x_content-->
      </div>
      <!--/x_panel-->
   </div>
   <!--/col-md-12-->

</div>


<script>
   $('.alink').off("click");
   $('.alink').on('click', function (obj) {
      go2View($(obj.target).attr('href'), 'Kapook Vending');
      return false;
   });


   function route_showdata(routeid) {

      $.get('/api/member/routeid/' + routeid, function (data) {
         routeid_editing = routeid;

         var objjquery = $('#route_edit_page');  //  <div class="row product_edit_page"> แก้ไขข้อมูล
         setdatabyclass(objjquery, 'route', data);  // product ชื่อเรียกนำหน้านำไปใช้คือ  <div class="product_name"
         console.log('viewing data');
         console.log(data);
         if ($('#routename').val()) {
            $(".chk_name").removeClass('text-help');
         }

         if ($('#areaname').val()) {
            $(".chk_area").removeClass('text-help');
         }
      });
   }



   $('#editRoute').on('submit', function () {  // ใช้กับ <form id="editPRD"
      var errortext;
      var routename = $('#routename').val();
      var areaname = $('#areaname').val();
      var description = $('#description').val();
      var status = $('#status').val();


      if (routename == '') {
         // ค่าว่าง
         errortext = 'กรุณากรอก Route Name';
         $(".chk_name").show();
         $(".chk_name").addClass("text-help");
         $('.chk_name').html('จำเป็นต้องกรอก');
      } else {
         // กรอกข้อมูลเข้ามา
         $(".chk_name").hide();
         $(".chk_name").removeClass("text-help");
      }

      if (areaname == '') {
         // ค่าว่าง
         errortext = 'กรุณากรอก Area Name';
         $(".chk_area").show();
         $(".chk_area").addClass("text-help");
         $('.chk_area').html('จำเป็นต้องกรอก');
      } else {
         // กรอกข้อมูลเข้ามา
         $(".chk_area").hide();
         $(".chk_area").removeClass("text-help");
      }


      var title = 'Edit Route';
      if (errortext) {
         // แจ้ง error
         new PNotify({
            title: title + ' Error',
            text: errortext,
            modules: {
               Animate: {
                  animate: true,
                  inClass: 'zoomInLeft',
                  outClass: 'zoomOutRight'
               }
            }
         });

         return false;
      } else {


         console.log("SUBMIT" + '/api/member/routeid/' + routeid_editing);
         var postdata = {route_id: routeid_editing, route_name: routename, route_area: areaname, route_description: description, route_status: status};



         console.log(postdata);
         $.post('/api/member/routeid/' + routeid_editing, postdata).done(function (data) {
            console.log("Send ค่า Post");
            //  แจ้งบันทึกสำเร็จ
            new PNotify({
               title: title + ' Success',
               text: 'บันทึกข้อมูลสำเร็จ',
               type: 'success'
            });
            console.log("SUBMIT data " + data);
         });
      }

      return false;
   });
</script>