<!--start Breadcrumb-->
<style>
   .text-help { font-size: 11px; font-weight: 500; color: #ff5722; }

</style>
<nav aria-label="breadcrumb">
   <ol class="breadcrumb" >
      <li class="breadcrumb-item"><a href="cpanel/home" class="alink">Dashboard</a></li>
      <li class="breadcrumb-item"><a href="cpanel/vansale/list" class="alink">Vansales</a></li>
      <li class="breadcrumb-item active" aria-current="page">Add</li>
   </ol>
</nav>
<!--/end Breadcrumb-->

<!-- // Start Content on PAGE /////////////////////////////////////////////////////// -->
<div class="row">
   <div class="content-title">
      <div class="col-md-7 col-sm-7 col-xs-12">
         <h2>Vansale <b>Add</b></h2>
      </div>
      <!--/col-->

      <!--/col-->
   </div>
   <!--/content-title-->
</div>
<!--/row-->

<div class="row" id="vansale_edit_page">
   <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="x_panel">
         <div class="x_title row">
            <div class="col-md-8">
               <p class="text-th">เพิ่มรายการ รถขนส่งสินค้า <b class="text-green">ใหม่ !!!</b></p>
            </div>

         </div>
         <!--/x_title-->
         <div class="x_content">
            <form id="editVansale" class="form-horizontal form-label-left" method="POST" data-parsley-validate="" novalidate>
               <input type="hidden" name="action" value="edited">
               <input id="bywho" name="bywho" value="" style="display:none;" />
               <input id="when" name="when" value="2019-06-28 12:10:08" style="display:none;" />
               <div class="row">
                  <div class="col col-md-3 col-sm-4 col-xs-12 col-image">
                    	<div class="form-group">
                        <i class="fa fa-fw fa-truck" style=" font-size:12vw; margin:0 auto;"></i>
                     </div>
                  </div><!--/col-->

                  <div class="col col-md-9 col-sm-8 col-xs-12">
                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12"><span class="required">*</span> Name</label>
                        <div class="col-md-9 col-sm-9 col-xs-12">
                           <input class="form-control col-md-7 col-xs-12 vansale_name" type="text" id="name" name="name" value="" required />
                           <div class="text-help chk_name"></div>
                        </div>
                     </div>
                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12"><span class="required">*</span> License</label>
                        <div class="col-md-9 col-sm-9 col-xs-12">
                           <input class="form-control col-md-7 col-xs-12 vansale_license" type="text" id="license" name="license" value="" required />
                           <div class="text-help chk_license"></div>
                        </div>
                     </div>


                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12">Route</label>
                        <div class="col-md-9 col-sm-12 col-xs-12">
                           <select id="select_route" name="route_id" class="form-control input-sm selectpicker selectCustomW100 vansale_routeid" style="width:100%;">
                              <!--
                            <option value="0" >...</option>
                            <option data-content="<b style='font-weight:600;'>Administrator</b> <span>(ผู้ดูแลระบบ)</span>" value="2" >Administrator</option>
                            <option data-content="<b style='font-weight:600;'>Monitor</b> <span>(ผู้ตรวจสอบ)</span>" value="3" >Monitor</option>
                            <option data-content="<b style='font-weight:600;'>Sales Officer</b> <span>(พนักงานขาย)</span>" value="11" >Sales Officer</option>
                            <option data-content="<b style='font-weight:600;'>VanSale Officer</b> <span>(พนักงานหน่วยรถ)</span>" value="12" >VanSale Officer</option> -->
                           </select>

                        </div>
                     </div>
                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12">Description</label>
                        <div class="col-md-9 col-sm-9 col-xs-12">
                           <textarea class="resizable_textarea form-control vansale_description"  rows="5" id="description" name="description" ></textarea>

                        </div>
                     </div>
                     <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12">Status</label>
                        <div class="col-md-9 col-sm-9 col-xs-12">
                           <select id="status"  class="vansale_status form-control input-sm selectpicker selectCustomW100">
                              <option value="1">เปิดการใช้งาน</option>
                              <option value="0">ปิดการใช้งาน</option>
                           </select>

                        </div>
                     </div>
                  </div>
                  <!--/col-->

               </div>
               <!--/row-->

               <div class="row">
                  <div class="ln_solid"></div>
                  <div class="col-md-4 col-sm-6 col-xs-12"><a href="/cpanel/vansale/list" class=" alink btn btn-default btn-lg btn-block">Back to Vansale Lists</a></div>
                  <div class="col-md-8 col-sm-6 col-xs-12">
                     <button class="btn btn-primary btn-lg btn-block" type="submit" >Add New Vansale</button>
                  </div>
               </div>
               <!--/row-->

            </form>
         </div>
         <!--/x_content-->
      </div>
      <!--/x_panel-->
   </div>
   <!--/col-md-12-->

</div>
<!--/row-->

<!-- // End Content on PAGE /////////////////////////////////////////////////////// -->

<script>
   $('.alink').off("click");
   $('.alink').on('click', function (obj) {
      go2View($(obj.target).attr('href'), 'Kapook Vending');
      return false;
   });

   console.log("objdata");

   $.get('/api/member/routelist_status1', function (objdata) {  // หยิบที่สร้างใน nodered มา
      console.log(objdata);
      console.log('route', objdata);
      var seldata = ''; // ตั้งชื่อตัวแปรใหม่ ไปใช้กับ <select
      seldata += '<option value="' + 0 + '">...</option>';
      for (var x = 0; x < objdata.length; x++) {
         seldata += '<option value="' + objdata[x]._id + '">' + objdata[x].name + ' - ' + objdata[x].area + '</option>';
      }
      $('#select_route').html(seldata); // <select id ="select_category"
   });

   if ($('#name').val()) {
      $(".chk_name").removeClass('text-help');
   }
   if ($('#license').val()) {
      $(".chk_license").removeClass('text-help');

   }


   // Form Edit
   $('#editVansale').on('submit', function () {
      var errortext;

      var name = $('#name').val();
      var route = $('#select_route').val();
      var license = $('#license').val();
      var status = $('#status').val();
      var description = $('#description').val();

      if (name == '') {
         // ค่าว่าง
         errortext = 'กรุณากรอก Vansale Name';
         $(".chk_name").show();
         $(".chk_name").addClass("text-help");
         $('.chk_name').html('จำเป็นต้องกรอก');
      } else {
         // กรอกข้อมูลเข้ามา
         $(".chk_name").hide();
         $(".chk_name").removeClass("text-help");
      }

      if (license == '') {
         // ค่าว่าง
         errortext = 'กรุณากรอก License Name';
         $(".chk_license").show();
         $(".chk_license").addClass("text-help");
         $('.chk_license').html('จำเป็นต้องกรอก');
      } else {
         // กรอกข้อมูลเข้ามา
         $(".chk_license").hide();
         $(".chk_license").removeClass("text-help");
      }

      var title = 'Edit Vansale';
      if (errortext) {
         // แจ้ง error
         new PNotify({
            title: title + ' Error',
            text: errortext,
            modules: {
               Animate: {
                  animate: true,
                  inClass: 'zoomInLeft',
                  outClass: 'zoomOutRight'
               }
            }
         });
         return false;
      } else {

//         console.log("SUBMIT" + '/api/member/vansale_add');
         var postdata = {van_name: name, van_status: status, van_description: description, van_routeid: route, van_license: license};
//
         console.log(postdata);
         $.post('/api/member/vansale_add/', postdata).done(function (data) {
            //  แจ้งบันทึกสำเร็จ
            new PNotify({
               title: title + ' Success',
               text: 'บันทึกข้อมูลสำเร็จ',
               type: 'success'
            });
            console.log("SUBMIT data " + data);
         });
      }

      console.log("return false");
      return false;
   }
   );

</script>

